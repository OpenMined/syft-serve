<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference - SyftServe</title>
    <link rel="icon" type="image/svg+xml" href="../images/syftbox-logo.svg">
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .api-method {
            background: white;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 12px;
            padding: var(--space-5);
            margin-bottom: var(--space-5);
            box-shadow: var(--shadow-sm);
        }
        
        .api-method:hover {
            box-shadow: var(--shadow-md);
        }
        
        .method-signature {
            background: var(--color-dark);
            color: white;
            padding: var(--space-3) var(--space-4);
            border-radius: 8px;
            font-family: var(--font-mono);
            font-size: 1.2rem;
            margin-bottom: var(--space-4);
            display: inline-block;
        }
        
        .method-description {
            font-size: 1.1rem;
            color: var(--color-gray);
            margin-bottom: var(--space-4);
            line-height: 1.6;
        }
        
        .params-section,
        .returns-section {
            background: var(--color-light-gray);
            border-radius: 8px;
            padding: var(--space-3);
            margin-bottom: var(--space-3);
        }
        
        .section-title {
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--color-gray);
            margin-bottom: var(--space-2);
        }
        
        .param-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .param-table th {
            text-align: left;
            padding: var(--space-2);
            border-bottom: 2px solid rgba(0,0,0,0.1);
            font-weight: 600;
            color: var(--color-dark);
        }
        
        .param-table td {
            padding: var(--space-2);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            vertical-align: top;
        }
        
        .param-name {
            font-family: var(--font-mono);
            color: var(--color-primary);
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .param-type {
            font-family: var(--font-mono);
            color: var(--color-accent);
            font-size: 0.9rem;
        }
        
        .param-desc {
            color: var(--color-gray);
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .example-section {
            margin-top: var(--space-4);
        }
        
        .example-section pre {
            margin: 0;
            background: var(--color-code-bg);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: var(--space-3);
        }
        
        .api-nav {
            position: sticky;
            top: 20px;
            background: white;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: var(--space-3);
            margin-bottom: var(--space-4);
        }
        
        .api-nav h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--color-gray);
            margin-bottom: var(--space-2);
        }
        
        .api-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .api-nav a {
            display: block;
            padding: var(--space-1) 0;
            color: var(--color-dark);
            text-decoration: none;
            font-size: 0.95rem;
            transition: color 0.2s;
        }
        
        .api-nav a:hover {
            color: var(--color-primary);
        }
        
        .api-content {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: var(--space-6);
            align-items: start;
        }
        
        @media (max-width: 1024px) {
            .api-content {
                grid-template-columns: 1fr;
            }
            
            .api-nav {
                position: static;
                margin-bottom: var(--space-6);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="nav-wrapper">
                <div class="logo-group">
                    <img src="../images/syftbox-logo.svg" alt="SyftBox" class="syftbox-logo">
                    <a href="../index.html" class="logo">SyftServe</a>
                </div>
                <div class="nav-links">
                    <a href="../quickstart.html">Quick Start</a>
                    <a href="../server-features.html">Server Features</a>
                    <a href="index.html" class="active">API</a>
                    <a href="https://github.com/OpenMined/syft-serve" class="github-link">GitHub</a>
                </div>
            </div>
        </nav>
    </header>

    <!-- API Hero -->
    <section class="api-hero">
        <div class="container">
            <h1>API Reference</h1>
            <p class="hero-subtitle">Complete documentation for all two functions. Yes, really.</p>
        </div>
    </section>

    <!-- API Content -->
    <section class="api-section">
        <div class="container">
            <div class="api-content">
                <!-- Navigation Sidebar -->
                <aside class="api-nav">
                    <h3>Quick Navigation</h3>
                    <ul>
                        <li><a href="#module-functions">Module Functions</a></li>
                        <li><a href="#server-object">Server Object</a></li>
                        <li><a href="#server-collection">Server Collection</a></li>
                        <li><a href="#environment-info">Environment Info</a></li>
                        <li><a href="#log-streams">Log Streams</a></li>
                    </ul>
                </aside>

                <!-- Main Content -->
                <div class="api-main">
                    <!-- Module Functions -->
                    <section id="module-functions">
                        <h2>Module Functions</h2>
                        
                        <div class="api-method">
                            <div class="method-signature">syft_serve.create(name, endpoints, dependencies=None, force=False)</div>
                            <p class="method-description">
                                Creates and launches a new FastAPI server with the specified endpoints. Each server runs in its own isolated virtual environment.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Type</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="param-name">name</span></td>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">Unique name for the server. Used to access it later via ss.servers["name"]</span></td>
                                        </tr>
                                        <tr>
                                            <td><span class="param-name">endpoints</span></td>
                                            <td><span class="param-type">Dict[str, Callable]</span></td>
                                            <td><span class="param-desc">Dictionary mapping URL paths to Python functions. Each function becomes an API endpoint</span></td>
                                        </tr>
                                        <tr>
                                            <td><span class="param-name">dependencies</span></td>
                                            <td><span class="param-type">List[str] | None</span></td>
                                            <td><span class="param-desc">Optional list of pip packages to install in the server's isolated environment</span></td>
                                        </tr>
                                        <tr>
                                            <td><span class="param-name">force</span></td>
                                            <td><span class="param-type">bool</span></td>
                                            <td><span class="param-desc">If True, replaces any existing server with the same name. Default: False</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">Server</span></td>
                                            <td><span class="param-desc">Server object with properties like url, port, status, and methods like terminate()</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Raises</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">ValueError</span></td>
                                            <td><span class="param-desc">If a server with the same name already exists and force=False</span></td>
                                        </tr>
                                        <tr>
                                            <td><span class="param-type">ServerStartupError</span></td>
                                            <td><span class="param-desc">If the server fails to start within the timeout period</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="example-section">
                                <div class="section-title">Example</div>
                                <pre><code class="language-python"># Simple server
def hello():
    return {"message": "Hello World!"}

server = syft_serve.create(
    name="hello_api",
    endpoints={"/hello": hello}
)

# Server with dependencies
def analyze_data():
    import pandas as pd
    # Your data processing logic here
    return {"status": "processed"}

data_server = syft_serve.create(
    name="data_api",
    endpoints={"/analyze": analyze_data},
    dependencies=["pandas", "numpy"]
)

# Multiple endpoints
api = syft_serve.create(
    name="full_api",
    endpoints={
        "/users": get_users,
        "/posts": get_posts,
        "/status": get_status
    }
)</code></pre>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">syft_serve.terminate_all()</div>
                            <p class="method-description">
                                Terminates all running servers, including orphaned processes from previous sessions. Properly cleans up all resources and child processes.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td colspan="2"><em>No parameters</em></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">None</span></td>
                                            <td><span class="param-desc">This function doesn't return a value</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="example-section">
                                <div class="section-title">Example</div>
                                <pre><code class="language-python"># Clean shutdown of all servers
syft_serve.terminate_all()

# After termination, the servers list is empty
print(syft_serve.servers)  # Empty table</code></pre>
                            </div>
                        </div>
                    </section>

                    <!-- Server Object -->
                    <section id="server-object">
                        <h2>Server Object</h2>
                        <p>The Server object is returned by create() and provides access to server properties and methods.</p>
                        
                        <div class="api-method">
                            <div class="method-signature">server.name</div>
                            <p class="method-description">
                                The unique name of the server as specified during creation.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">Server name</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.url</div>
                            <p class="method-description">
                                The full URL where the server is accessible.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">Server URL (e.g., "http://localhost:8000")</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.port</div>
                            <p class="method-description">
                                The port number where the server is listening.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">int</span></td>
                                            <td><span class="param-desc">Port number (e.g., 8000)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.status</div>
                            <p class="method-description">
                                Current status of the server process.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">"running", "terminated", or "unknown"</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.pid</div>
                            <p class="method-description">
                                Process ID of the server.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">int | None</span></td>
                                            <td><span class="param-desc">Process ID or None if not running</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.uptime</div>
                            <p class="method-description">
                                Human-readable uptime of the server.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">"2m 15s", "1h 45m", or "-" if not running</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.endpoints</div>
                            <p class="method-description">
                                List of endpoint paths defined for this server.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">List[str]</span></td>
                                            <td><span class="param-desc">List of endpoint paths (e.g., ["/hello", "/status"])</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.terminate()</div>
                            <p class="method-description">
                                Terminates this specific server and all its child processes.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td colspan="2"><em>No parameters</em></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">None</span></td>
                                            <td><span class="param-desc">This method doesn't return a value</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="example-section">
                                <div class="section-title">Example</div>
                                <pre><code class="language-python"># Terminate a specific server
server.terminate()

# The server is no longer in the servers list
print(server.name in syft_serve.servers)  # False</code></pre>
                            </div>
                        </div>
                    </section>

                    <!-- Server Collection -->
                    <section id="server-collection">
                        <h2>Server Collection</h2>
                        <p>The servers collection provides access to all running servers.</p>
                        
                        <div class="api-method">
                            <div class="method-signature">syft_serve.servers</div>
                            <p class="method-description">
                                Global collection of all running servers. Displays as an interactive table in Jupyter notebooks.
                            </p>
                            
                            <div class="example-section">
                                <div class="section-title">Example</div>
                                <pre><code class="language-python"># View all servers
syft_serve.servers

# Output (in Jupyter):
# Name         Port  Status     Endpoints          Uptime    PID
# ----------  ------  ---------  ---------------  --------  -----
# hello_api    8000  ✅ Running  /hello            2m 15s   1234
# data_api     8001  ✅ Running  /process          45s      5678</code></pre>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">syft_serve.servers[name]</div>
                            <p class="method-description">
                                Access a server by its name.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Type</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="param-name">name</span></td>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">Name of the server</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">Server</span></td>
                                            <td><span class="param-desc">Server object</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Raises</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">KeyError</span></td>
                                            <td><span class="param-desc">If no server with that name exists</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">syft_serve.servers[index]</div>
                            <p class="method-description">
                                Access a server by its index in the collection.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Type</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="param-name">index</span></td>
                                            <td><span class="param-type">int</span></td>
                                            <td><span class="param-desc">Zero-based index</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">Server</span></td>
                                            <td><span class="param-desc">Server object</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- Environment Info -->
                    <section id="environment-info">
                        <h2>Environment Info</h2>
                        
                        <div class="api-method">
                            <div class="method-signature">server.env</div>
                            <p class="method-description">
                                Access to the server's isolated virtual environment information. Displays as a tree view in Jupyter notebooks.
                            </p>
                            
                            <div class="example-section">
                                <div class="section-title">Example</div>
                                <pre><code class="language-python"># View installed packages
server.env

# Output (in Jupyter):
# 📦 data_api environment
# ├── pandas==2.0.0
# ├── numpy==1.24.3
# └── python-dateutil==2.8.2</code></pre>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.env.list()</div>
                            <p class="method-description">
                                Get a list of all installed packages in the server's environment.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">List[str]</span></td>
                                            <td><span class="param-desc">List of installed packages with versions</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- Log Streams -->
                    <section id="log-streams">
                        <h2>Log Streams</h2>
                        <p>Access server logs without hunting for log files.</p>
                        
                        <div class="api-method">
                            <div class="method-signature">server.stdout</div>
                            <p class="method-description">
                                Access to the server's standard output stream.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">LogStream</span></td>
                                            <td><span class="param-desc">Log stream object with methods for viewing logs</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">server.stderr</div>
                            <p class="method-description">
                                Access to the server's standard error stream.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Type</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">LogStream</span></td>
                                            <td><span class="param-desc">Log stream object with methods for viewing error logs</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">stream.tail(n=10)</div>
                            <p class="method-description">
                                Get the last n lines from the log stream.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Type</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="param-name">n</span></td>
                                            <td><span class="param-type">int</span></td>
                                            <td><span class="param-desc">Number of lines to return (default: 10)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">Last n lines of the log</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">stream.head(n=10)</div>
                            <p class="method-description">
                                Get the first n lines from the log stream.
                            </p>
                            
                            <div class="params-section">
                                <div class="section-title">Parameters</div>
                                <table class="param-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Type</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="param-name">n</span></td>
                                            <td><span class="param-type">int</span></td>
                                            <td><span class="param-desc">Number of lines to return (default: 10)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">str</span></td>
                                            <td><span class="param-desc">First n lines of the log</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="api-method">
                            <div class="method-signature">stream.lines()</div>
                            <p class="method-description">
                                Get all lines from the log stream as a list.
                            </p>
                            
                            <div class="returns-section">
                                <div class="section-title">Returns</div>
                                <table class="param-table">
                                    <tbody>
                                        <tr>
                                            <td><span class="param-type">List[str]</span></td>
                                            <td><span class="param-desc">All log lines as a list</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="example-section">
                                <div class="section-title">Example</div>
                                <pre><code class="language-python"># View recent logs
print(server.stdout.tail(20))

# Debug startup issues
print(server.stdout.head(50))

# Search through all logs
for line in server.stderr.lines():
    if "error" in line.lower():
        print(line)</code></pre>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2024 OpenMined. Part of the <a href="https://syftbox.org">SyftBox</a> ecosystem.</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>